# 思阅 SiReader - 更新日志
---

## 🚀 v0.5.0 (2025.12.12)

### ✨ 核心功能
- **📚 阅读引擎升级** - 完全替换为 foliate-js，支持 EPUB、MOBI、PDF、TXT、在线小说
- **⌨️ 快捷键翻页** - 支持方向键、PageUp/Down、空格键快捷翻页
- **🎹 自定义快捷键** - 支持思源自定义快捷键（上一页、下一页、切换书签）
- **🔗 智能链接跳转** - 支持 `sireader://` 协议，点击链接自动跳转到指定位置，避免重复打开
- **� 卡能包功能** - 支持词汇卡包管理，便于学习和复习
- **� 词典系统*** - 支持 StarDict/MDict 离线词典和在线词典，选中文本即可查词
- **🌐 AI 翻译** - 集成思源 AI 翻译和查词功能

### 📚 书架与搜索
- **📖 本地导入** - 支持选择本地 EPUB/MOBI/PDF/TXT 文件导入书架
- **🔍 智能搜索** - 支持按书名、作者搜索，多种排序方式（时间/书名/作者/更新）
- **📋 多视图** - 支持网格、列表、简洁三种显示模式
- **� 主书源搜索** - 支持多书源并发搜索，流式显示结果，一键添加到书架
- **� 更o新检查** - 一键检查所有在线书籍更新
- **📖 元数据解析** - 自动解析 EPUB 元数据（书名、作者、简介、章节、封面）

### 🎨 阅读与标注
- **� 目件录导航** - 使用 foliate-js 原生目录，支持搜索和智能定位
- **� 书签管优理** - 添加、删除、跳转书签
- **🌈 7色标注** - 红🔴橙🟠黄🟡绿🟢粉🩷蓝🔵紫🟣，支持添加笔记
- **🎨 4种样式** - 高亮、下划线、边框、波浪线，自由组合
- **🔍 颜色筛选**（待支持） - 按颜色筛选标注，批量管理
- **💾 持久化** - 标注数据独立存储，使用 CFI 精确定位

### � 界面与位设置
- **⚙️ 设置面板** - 全新设计，分类清晰：通用、外观、词典
- **📋 侧边栏** - 优化按钮顺序：书架→搜索→卡包→目录→书签→标注→笔记→通用→样式→词典
- **🎨 主题系统** - 统一使用思源主题色，完美融入界面
- **� 外外观设置** - 字体、字号、字距、行距、段落间距、首行缩进全面可调
- **📏 布局设置** - 左右边距、上下边距、列间距、页眉页脚高度精细控制
- **🌈 视觉效果** - 亮度、对比度、褐色、饱和度、反色滤镜
- **📖 阅读模式** - 单页/双页、滑动/滚动翻页、目录左右切换

### � 链接与复制
- **📋 格式化链接** - 支持自定义模板，默认使用思源 callout 格式
- **🎯 精准定位** - 使用 CFI 精确定位到书籍位置
- **📖 章节识别** - 自动识别当前章节，生成包含章节信息的链接
- **🔗 智能跳转** - 点击链接自动检测已打开书籍，直接跳转

### ⚡ 性能与优化
- **📦 架构优化** - 业务逻辑移至 composable，组件更清晰
- **� 响应式** - 设置修改实时生效，无需刷新
- **💾 智能缓存** - 缓存书籍信息，减少重复加载
- **🎯 函数式编程** - 使用 reduce/map/filter 简化代码
- **� 类型化安全** - 完善 TypeScript 类型定义

### 🐛 问题修复
- **✅ 字体设置** - 修复字体不生效问题（使用完整 URL 路径）
- **✅ 主题应用** - 修复主题不应用到整个 tab 的问题
- **✅ 响应式更新** - 修复设置更新后阅读界面不响应
- **✅ 章节获取** - 修复章节信息无法正确获取
- **✅ 作者格式化** - 支持字符串/对象/数组多种格式
- **✅ 链接编码** - 修复中文链接编码问题
- **✅ 国际化** - 修复 tooltip 显示英文的问题
- **✅ 封面解析** - 修复 EPUB 封面解析失败导致循环重试的问题，失败时自动使用文字封面
- **✅ 快捷键冲突** - 修复快捷键在编辑时仍然生效的问题，仅在阅读时响应

### 📦 v0.2.7 (2025.11.29)
#### ✨ 新增功能
- **📚 自定义书源** - 支持通过思源代码片段配置自定义书源，极限精简设计
- **🔍 书源搜索** - 支持多书源并发搜索，智能聚合结果
- **📖 在线阅读** - 支持在线阅读网络小说，章节导航流畅
- **💾 EPUB导出** - 支持将在线小说导出为标准EPUB格式
#### 🛠️ 功能优化
- **⚡ 极限精简** - 借鉴mplayer设计，通过window对象读取配置，零延迟
- **🎯 调试增强** - 添加详细的控制台日志，便于排查问题
- **📋 书源管理** - 11个测试书源（古登堡、追书、SF轻小说、起点等）
- **🔧 规则引擎** - 支持CSS选择器、XPath、JSONPath、正则表达式
#### 📖 文档完善
- **📚 调试指南** - 完整的调试步骤和常见问题解决方案（DEBUG-BOOKSOURCE.md）
- **💡 示例配置** - 提供11个测试书源示例（docs/siyuan-book-sources.js）

---

### 📦 v0.3.0 (2025.11.29)
#### ✨ 新增功能
- **🎯 目录钉住** - 目录面板支持钉住功能，钉住后自动调整阅读区域宽度，避免内容遮挡
- **📍 目录位置切换** - 支持左侧/右侧目录位置实时切换，设置后立即生效无需刷新
- **📄 单页双页显示** - 优化显示模式，支持单页/双页视图切换，阅读体验更灵活
- **⚙️ 文档绑定设置** - 目录面板新增设置功能，可为当前书籍重新绑定思源笔记文档
- **🔍 智能文档搜索** - 设置界面支持文档搜索选择，输入关键词快速定位目标文档
- **🔤 文本自定义设置** - 新增字体选择(默认/衬线/无衬线/微软雅黑/宋体/楷体)*、字号调节(12-32px)、字距控制  
  *注：字体效果可能不生效
- **📏 段落排版设置** - 支持行距调节(1.0-3.0倍)、段落间距设置(0-2em)、首行缩进控制(0-2em)
- **📋 页面布局设置** - 可调节左右边距(0-100px)、上下边距(0-80px)、连续滚动开关、一键恢复默认

#### 🛠️ 架构重构
- **📋 设置面板重构** - 重新设计设置界面，划分为界面、外观、标注三大模块
- **⚡ 响应式更新机制** - 统一所有设置项的响应式更新逻辑，修改设置立即生效
- **🎨 样式应用优化** - 修复翻页后主题样式回退问题，确保样式持久应用

#### 🐛 问题修复
- **✅ 修复** - 翻页后主题回到旧样式的缓存问题
- **✅ 修复** - 设置更新不能及时响应的问题  
- **✅ 修复** - 目录钉住后内容区域布局错位问题
- **✅ 移除** - 已废弃的翻页方式设置，简化用户界面

### 📦 v0.2.6 (2025.11.27)
#### ✨ 新增功能
- **💡 笔记功能** - 支持为书籍内容添加详细笔记，记录阅读心得
- **✏️ 编辑功能** - 可编辑已有的笔记和标注内容，支持实时修改
- **🎯 智能标注** - 支持7种颜色标注（红🔴橙🟠黄🟡绿🟢粉🩷蓝🔵紫🟣），一键切换
- **📝 笔记管理** - 统一的笔记输入框，支持数字输入、删除和外部点击关闭
#### 🛠️ 功能优化
- **⚙️ 设置保存逻辑** - 修复Vue响应式对象序列化问题，确保配置正确保存
- **📋 文档选择优化** - 搜索结果为单个时自动选择并保存，提升使用体验
- **🎨 UI组件统一** - 颜色选择器和笔记输入框使用统一的创建逻辑
- **🚀 性能提升** - 缓存机制优化，减少重复查询，提升响应速度
#### 🐛 问题修复
- **✅ 修复** - 标注颜色修改不生效的问题
- **✅ 修复** - 设置保存后重新打开丢失的问题
- **✅ 修复** - 文档选择结果唯一时无法触发保存的问题

